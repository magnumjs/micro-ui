/*!
 * @magnumjs/micro-ui v1.0.15
 * Author: Michael Glazer
 * Website: https://github.com/magnumjs/micro-ui#readme
 */
var MicroUI=(()=>{var B=Object.defineProperty;var J=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var D=(e,n)=>{for(var t in n)B(e,t,{get:n[t],enumerable:!0})},V=(e,n,t,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of K(n))!R.call(e,i)&&i!==t&&B(e,i,{get:()=>n[i],enumerable:!(s=J(n,i))||s.enumerable});return e};var W=e=>V(B({},"__esModule",{value:!0}),e);var Q={};D(Q,{context:()=>H,createComponent:()=>Z,createState:()=>I,renderList:()=>G,shared:()=>O});function P(e,n={}){if(typeof e!="string")return"";let{children:t={},slots:s={}}=n;function i(u,o){return u?t&&typeof t=="object"&&t[u]!=null?t[u]:s&&typeof s=="object"&&s[u]!=null?s[u]:o:t&&typeof t=="object"&&t.default!=null?t.default:s&&typeof s=="object"&&s.default!=null?s.default:typeof t=="string"?t:o}return e=e.replace(/<slot(?:\s+name="([^"]+)")?>([\s\S]*?)<\/slot>/gis,(u,o,p)=>i(o,p)),e=e.replace(/<([a-z]+)([^>]*)\sdata-slot="([^"]+)"([^>]*)>([\s\S]*?)<\/\1>/gis,(u,o,p,r,f,c)=>{let h=i(r,c);return`<${o}${p}${f}>${h}</${o}>`}),e}function q(e,n){if(!e)return!1;let t=document.createElement("div");t.innerHTML=n;let s=Array.from(t.children),i=Array.from(e.children),u=new Map,o=new Map;for(let r of s){let f=r.dataset.key;f&&u.set(f,r)}for(let r of i){let f=r.dataset.key;f&&o.set(f,r)}let p=0;for(let r of s){let f=r.dataset.key,c=e.children[p];if(f&&o.has(f)){let h=o.get(f);h.innerHTML!==r.innerHTML&&(h.innerHTML=r.innerHTML),h!==c&&e.insertBefore(h,c||null),o.delete(f)}else e.insertBefore(r,c||null);p++}for(let r of o.values())r.remove();for(;e.children.length>s.length;)e.lastChild.remove();return!0}function _(e,n,t,s){if(!n||!t)return;let i=n.firstElementChild;i&&Object.entries(t).forEach(([u,o])=>{let p=u.includes(":"),[r,f]=p?u.split(":"):u.split(" "),c=r==="*";(c?["click","input","change","keydown","submit"]:[r]).forEach(E=>{let C=m=>{let v=m.target.closest("[data-action]"),y=v?.dataset.action||"",T=v?.dataset.args,L=y.split(":"),$=L[0],M=[];if(T)try{let S=JSON.parse(T);M=Array.isArray(S)?S:[S]}catch{console.warn("Invalid JSON in data-args:",T)}else M=L.slice(1);let a={event:m,state:e.state,setState:e.setState,props:e.props,refs:e.refs,action:$,args:M};if(p&&v&&(f==="*"||f===$)&&(c||m.type===r))return o.call(e,a);if(!p){let S=m.target.closest(f||"*");if(S&&i.contains(S))return o.call(e,a)}},g=`__microBound_${E}_${u}`;i[g]||(i.addEventListener(E,C),i[g]=!0,s.push({node:i,type:E,listener:C}))})})}function I(e){let n=e,t=new Set;function s(o){n=typeof o=="function"?o(n):{...n,...o},t.forEach(p=>p(n))}function i(o){return t.add(o),o(n),()=>t.delete(o)}function u(){return n}return{get:u,setState:s,getState:u,subscribe:i}}var x=new Map,H={subscribe(e,n){x.has(e)||x.set(e,new Set);let t=x.get(e);return t.add(n),()=>t.delete(n)},emit(e,n){let t=x.get(e);if(t)for(let s of t)s(n)},clear(){x.clear()}},N=new Map;function O(e,n={}){if(!N.has(e)){let t=I(n),s={...t,emit(i,u){t.setState(u),H.emit(`${e}::${i}`,t.getState())},on(i,u){return H.subscribe(`${e}::${i}`,u)}};N.set(e,s)}return N.get(e)}O.clear=()=>N.clear();function Z(e,{state:n={},on:t={},onMount:s,onUnmount:i,onBeforeMount:u,onBeforeUnmount:o,onUpdate:p}={}){let r=null,f=!1,c={},h={},E=null,C=!1,g=[],m=n,v=null,y=!1,T={...n},L=!1,$=[],M=l=>{m=typeof l=="function"?l(m):{...m,...l},L||(L=!0,E={...c},queueMicrotask(()=>{L=!1,j(E),E=null}))},a={refs:{},setState:M,props:c,mount(l,d={}){if(f||C)return;let b=typeof l=="string"?document.querySelector(l):l;if(!b)throw new Error(`No element matches: ${l}`);A(u,()=>{C=!0,r=b,c={...c,...d},h={...c},a.props=c,j(c),_(a,r,t,g),y||(f=!0,s?.call(a),S())})},update(l={}){if(!f)return;let d=l.props?l.props:l,b=d.on;b&&b!==t&&(t=b);let w={...c,...d};h={...c},c=w,a.props=c,j(c)},render(l={}){c={...c,...l},a.props=c;let d=typeof e=="function"?e.call(a,{state:m,setState:M,props:c,refs:a.refs}):e;return d=P(d,c),d},_resetInternal:()=>{v=null,y=!1,r=null,f=!1,C=!1,g=[],c={},h={},m={...T}},unmount(){if(!f||!r)return;A(o,()=>{r.firstChild&&(v=r.firstChild.cloneNode(!0),r.removeChild(r.firstChild)),g.forEach(({node:d,type:b,listener:w})=>{d.removeEventListener(b,w)}),g=[],$.forEach(d=>d()),$=[],f=!1,C=!1,y=!0,i?.call(a),a._resetInternal&&a._resetInternal()})},get renderFn(){return e},get el(){return r},get state(){return m}};a.ref=function(l){return this.el&&(this.el.querySelector(`[data-ref="${l}"]`)||this.el.querySelector(l))||null},a.refs=new Proxy({},{get(l,d){return a.ref(d)}}),a.action=function(l){return l.target.closest("[data-action]")?.dataset.action||null};function S(){$=[],Object.entries(t).forEach(([l,d])=>{if(l.includes("::")){let b=d.bind(a),w=H.subscribe(l,b);$.push(w)}})}function j(l){c=l,a.props=c;let d=a.render(c);if(d===null||d===""){!y&&r&&r.firstChild?(v=r.firstChild.cloneNode(!0),A(o,()=>{r.innerHTML="",g.forEach(({node:w,type:k,listener:z})=>{w.removeEventListener(k,z)}),g=[],f=!1,y=!0,i?.call(a)})):y=!0;return}if(y&&v){r.appendChild(v),v=null,y=!1,f=!0,_(a,r,t,g),s?.call(a);return}y=!1,q(r,d),_(a,r,t,g),f&&p&&p.call(a,h)}function A(l,d){l?l.length?l.call(a,d):Promise.resolve(l.call(a)).then(d):d()}return a}function G(e,n,t=s=>s.id??s.key??s){return e.map((s,i)=>{let u=t(s,i),o=n(s,i);return typeof o=="string"?o.replace(/^<([a-zA-Z0-9-]+)/,`<$1 data-key="${String(u).replace(/"/g,"&quot;")}"`):o}).join("")}return W(Q);})();
//# sourceMappingURL=magnumjs-micro-ui.js.map
