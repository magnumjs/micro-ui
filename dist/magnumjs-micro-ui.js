/*!
 * @magnumjs/micro-ui v1.0.12
 * Author: Michael Glazer
 * Website: https://github.com/magnumjs/micro-ui#readme
 */
var MicroUI=(()=>{var L=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var I=Object.prototype.hasOwnProperty;var q=(e,t)=>{for(var r in t)L(e,r,{get:t[r],enumerable:!0})},z=(e,t,r,l)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of B(t))!I.call(e,u)&&u!==r&&L(e,u,{get:()=>t[u],enumerable:!(l=A(t,u))||l.enumerable});return e};var K=e=>z(L({},"__esModule",{value:!0}),e);var G={};q(G,{createComponent:()=>O,createState:()=>D,renderList:()=>Z});function $(e,t={}){if(typeof e!="string")return"";let{children:r={},slots:l={}}=t;function u(a,o){return a?r&&typeof r=="object"&&r[a]!=null?r[a]:l&&typeof l=="object"&&l[a]!=null?l[a]:o:r&&typeof r=="object"&&r.default!=null?r.default:l&&typeof l=="object"&&l.default!=null?l.default:typeof r=="string"?r:o}return e=e.replace(/<slot(?:\s+name="([^"]+)")?>([\s\S]*?)<\/slot>/gis,(a,o,s)=>u(o,s)),e=e.replace(/<([a-z]+)([^>]*)\sdata-slot="([^"]+)"([^>]*)>([\s\S]*?)<\/\1>/gis,(a,o,s,f,n,y)=>{let p=u(f,y);return`<${o}${s}${n}>${p}</${o}>`}),e}function M(e,t){if(!e)return!1;let r=document.createElement("div");r.innerHTML=t;let l=Array.from(r.children),u=Array.from(e.children),a=new Map,o=new Map;for(let f of l){let n=f.dataset.key;n&&a.set(n,f)}for(let f of u){let n=f.dataset.key;n&&o.set(n,f)}let s=0;for(let f of l){let n=f.dataset.key,y=e.children[s];if(n&&o.has(n)){let p=o.get(n);p.innerHTML!==f.innerHTML&&(p.innerHTML=f.innerHTML),p!==y&&e.insertBefore(p,y||null),o.delete(n)}else e.insertBefore(f,y||null);s++}for(let f of o.values())f.remove();for(;e.children.length>l.length;)e.lastChild.remove();return!0}function D(e){let t=e,r=new Set;function l(o){t=typeof o=="function"?o(t):{...t,...o},r.forEach(s=>s(t))}function u(o){return r.add(o),o(t),()=>r.delete(o)}function a(){return t}return{get:a,setState:l,getState:a,subscribe:u}}function O(e,{state:t={},on:r={},onMount:l,onUnmount:u,onBeforeMount:a,onBeforeUnmount:o}={}){let s=null,f=!1,n={},y=!1,p=[],m=t,v=null,g=!1,j={...t},E=i=>{m=typeof i=="function"?i(m):{...m,...i},_(n)},d={refs:{},setState:E,props:n,mount(i){if(f||y)return;let c=typeof i=="string"?document.querySelector(i):i;if(!c)throw new Error(`No element matches: ${i}`);H(a,()=>{y=!0,s=c,_(n),g||(f=!0,l?.call(d))})},update(i={}){if(!f)return;let c=i.on;c&&c!==r&&(r=c),n={...n,...i},d.props=n,_(n)},render(i={}){n={...n,...i},d.props=n;let c=typeof e=="function"?e.call(d,{state:m,setState:E,props:n,refs:d.refs}):e;return c=$(c,n),c},_resetInternal:()=>{v=null,g=!1,f=!1,y=!1,p=[],n={},m={...j}},unmount(){if(!f||!s)return;H(o,()=>{s.firstChild&&(v=s.firstChild.cloneNode(!0),s.removeChild(s.firstChild)),p.forEach(({node:c,type:h,listener:C})=>{c.removeEventListener(h,C)}),p=[],f=!1,y=!1,g=!0,u?.call(d),d._resetInternal&&d._resetInternal()})},get renderFn(){return e},get el(){return s},get state(){return m}};function _(i){n=i;let c=d.render(n);if(c===null||c===""){if(!g&&s&&s.firstChild){let h=s.firstChild;v=h.cloneNode(!0),H(o,()=>{s.contains(h)&&s.removeChild(h),f=!1,g=!0,u?.call(d)})}else g=!0;return}if(g&&v){s.appendChild(v),v=null,g=!1,f=!0,S(),l?.call(d);return}g=!1,M(s,c),d.refs={},s&&s.querySelectorAll("[data-ref]").forEach(h=>{d.refs[h.dataset.ref]=h}),S()}function S(){if(!s||!r)return;let i=s.firstElementChild;i&&Object.entries(r).forEach(([c,h])=>{let[C,b]=c.split(" ");if(!C)return;let T=w=>{let N=b?w.target.closest(b):w.target;N&&i.contains(N)&&h.call(d,{event:w,state:m,setState:E,props:n,refs:d.refs})},k=`__microBound_${C}_${b||"root"}`;i[k]||(i.addEventListener(C,T),i[k]=!0,p.push({node:i,type:C,listener:T}))})}return d}function H(e,t){e?e.length?e(t):Promise.resolve(e()).then(t):t()}function Z(e,t,r=l=>l.id??l.key??l){return e.map((l,u)=>{let a=r(l,u),o=t(l,u);return typeof o=="string"?o.replace(/^<([a-zA-Z0-9-]+)/,`<$1 data-key="${String(a).replace(/"/g,"&quot;")}"`):o}).join("")}return K(G);})();
//# sourceMappingURL=magnumjs-micro-ui.js.map
