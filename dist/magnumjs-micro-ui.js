/*!
 * @magnumjs/micro-ui v1.0.17
 * Author: Michael Glazer
 * Website: https://github.com/magnumjs/micro-ui#readme
 */
var MicroUI=(()=>{var P=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var Z=Object.getOwnPropertyNames;var k=Object.prototype.hasOwnProperty;var F=(e,n)=>{for(var t in n)P(e,t,{get:n[t],enumerable:!0})},G=(e,n,t,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of Z(n))!k.call(e,s)&&s!==t&&P(e,s,{get:()=>n[s],enumerable:!(r=X(n,s))||r.enumerable});return e};var Q=e=>G(P({},"__esModule",{value:!0}),e);var se={};F(se,{context:()=>H,createComponent:()=>ne,createState:()=>J,renderList:()=>re,shared:()=>K});function q(e,n={}){if(typeof e!="string")return"";let{children:t={},slots:r={}}=n;function s(o,c){let a;if(o)a=t?.[o]??r?.[o]??c;else if(t&&typeof t=="object"&&t.default!=null)a=t.default;else if(r&&typeof r=="object"&&r.default!=null)a=r.default;else if(typeof t=="string")a=t;else return c;if(typeof a=="function"&&(a=a()),a?.el instanceof HTMLElement)return a.el.outerHTML;if(a instanceof Node){let i=document.createElement("div");return i.appendChild(a.cloneNode(!0)),i.innerHTML}return a??c}return e=e.replace(/<slot(?:\s+name="([^"]+)")?>([\s\S]*?)<\/slot>/gis,(o,c,a)=>s(c,a)),e=e.replace(/<([a-z]+)([^>]*)\sdata-slot="([^"]+)"([^>]*)>([\s\S]*?)<\/\1>/gis,(o,c,a,i,p,f)=>{let m=s(i,f);return`<${c}${a}${p}>${m}</${c}>`}),e}function B(e,n){if(!e)return!1;let t=document.createElement("div");if(t.innerHTML=n,t.children.length===0&&t.textContent)return e.textContent=t.textContent,!0;let r=Array.from(t.children),s=Array.from(e.children),o=new Map,c=new Map;for(let i of r){let p=i.dataset.key;p&&o.set(p,i)}for(let i of s){let p=i.dataset.key;p&&c.set(p,i)}let a=0;for(let i of r){let p=i.dataset.key,f=e.children[a];if(p&&c.has(p)){let m=c.get(p);z(m,i),m!==f&&e.insertBefore(m,f||null),c.delete(p)}else e.insertBefore(i,f||null);a++}for(let i of c.values())i.remove();for(;e.children.length>r.length;)e.lastChild.remove();return!0}function z(e,n){Y(e,n),U(e,n)}function Y(e,n){let t=e.attributes,r=n.attributes;for(let{name:s}of Array.from(t))n.hasAttribute(s)||e.removeAttribute(s);for(let{name:s,value:o}of Array.from(r))e.getAttribute(s)!==o&&e.setAttribute(s,o)}function U(e,n){let t=Array.from(e.childNodes),r=Array.from(n.childNodes),s=Math.max(t.length,r.length);for(let o=0;o<s;o++){let c=t[o],a=r[o];if(!a&&c){e.removeChild(c);continue}if(!c&&a){e.appendChild(a.cloneNode(!0));continue}ee(c,a)}}function ee(e,n){if(!e.isEqualNode(n)){if(e.nodeType!==n.nodeType){e.replaceWith(n.cloneNode(!0));return}e.nodeType===Node.TEXT_NODE?e.nodeValue!==n.nodeValue&&(e.nodeValue=n.nodeValue):e.nodeType===Node.ELEMENT_NODE&&e.tagName===n.tagName?z(e,n):e.replaceWith(n.cloneNode(!0))}}function L(e,n,t,r){if(!n||!t)return;let s=n.firstElementChild;s&&Object.entries(t).forEach(([o,c])=>{let a=o.includes(":"),[i,p]=a?o.split(":"):o.split(" "),f=i==="*";(f?["click","input","change","keydown","submit"]:[i]).forEach(T=>{let A=y=>{let b=y.target.closest("[data-action]"),C=b?.dataset.action||"",x=b?.dataset.args,w=C.split(":"),_=w[0],M=[];if(x)try{let v=JSON.parse(x);M=Array.isArray(v)?v:[v]}catch{console.warn("Invalid JSON in data-args:",x)}else M=w.slice(1);let u={event:y,state:e.state,setState:e.setState,props:e.props,refs:e.refs,action:_,args:M};if(a&&b&&(p==="*"||p===_)&&(f||y.type===i))return c.call(e,u);if(!a){let v=y.target.closest(p||"*");if(v&&s.contains(v))return c.call(e,u)}},g=`__microBound_${T}_${o}`;s[g]||(s.addEventListener(T,A),s[g]=!0,r.push({node:s,type:T,listener:A}))})})}function J(e){let n=e,t=new Set;function r(c){n=typeof c=="function"?c(n):{...n,...c},t.forEach(a=>a(n))}function s(c){return t.add(c),c(n),()=>t.delete(c)}function o(){return n}return{get:o,setState:r,getState:o,subscribe:s}}var $=new Map,H={subscribe(e,n){$.has(e)||$.set(e,new Set);let t=$.get(e);return t.add(n),()=>t.delete(n)},emit(e,n){let t=$.get(e);if(t)for(let r of t)r(n)},clear(){$.clear()}},j=new Map;function K(e,n={}){if(!j.has(e)){let t=J(n),r={...t,emit(s,o){t.setState(o),H.emit(`${e}::${s}`,t.getState())},on(s,o){return H.subscribe(`${e}::${s}`,o)}};j.set(e,r)}return j.get(e)}K.clear=()=>j.clear();function I(e,n){if(!e||n==null)return;let t=typeof n=="function"?n():n;if(Array.isArray(t)){let r=document.createDocumentFragment();t.forEach(s=>{if(s&&typeof s.mount=="function"){let o=document.createElement("div");s.mount(o),o.firstElementChild&&r.appendChild(o.firstElementChild)}else if(s?.el instanceof HTMLElement)r.appendChild(s.el);else if(s instanceof Node)r.appendChild(s);else if(typeof s=="string"){let o=document.createElement("div");o.innerHTML=s,o.firstElementChild&&r.appendChild(o.firstElementChild)}}),e.replaceWith(r);return}if(t&&typeof t.mount=="function"){let r=document.createElement("div");e.replaceWith(r),t.mount(r)}else if(t?.el instanceof HTMLElement)e.replaceWith(t.el);else if(t instanceof Node)e.replaceWith(t);else if(typeof t=="string"){let r=document.createElement("div");r.innerHTML=t,r.firstElementChild&&e.replaceWith(r.firstElementChild)}}var te=0;function ne(e,{state:n={},on:t={},onMount:r,onUnmount:s,onBeforeMount:o,onBeforeUnmount:c,onUpdate:a}={}){let i=null,p=!1,f={},m={},T=null,A=!1,g=[],y=n,b=null,C=!1,x={...n},w=!1,_=[],M=l=>{y=typeof l=="function"?l(y):{...y,...l},w||(w=!0,T={...f},queueMicrotask(()=>{w=!1,h(T),T=null}))},u={refs:{},setState:M,props:f,mount(l,d={}){if(p||A)return;let E=typeof l=="string"?document.querySelector(l):l;if(!E)throw new Error(`No element matches: ${l}`);N(o,()=>{A=!0,i=E,f={...f,...d},m={...f},u.props=f,h(f);let O={...f.slots||{},children:f.children};Object.entries(O).forEach(([W,V])=>{let D=h.refs[W];!D||V==null||I(D,V)}),L(u,i,t,g),C||(p=!0,r?.call(h),v())})},update(l={}){if(!p)return;let d=l.props?l.props:l,E=d.on;E&&E!==t&&(t=E);let S={...f,...d};m={...f},f=S,u.props=f,h(f)},render(l={}){f={...f,...l},u.props=f;let d=typeof e=="function"?e.call(u,{state:y,setState:M,props:f,refs:u.refs}):e;return d=q(d,f),d&&(d=new String(d),d._id=h._id),d},_resetInternal:()=>{b=null,C=!1,i=null,p=!1,A=!1,g=[],f={},m={},y={...x}},unmount(){if(!p||!i)return;N(c,()=>{i.firstChild&&(b=i.firstChild.cloneNode(!0),i.removeChild(i.firstChild)),g.forEach(({node:d,type:E,listener:S})=>{d.removeEventListener(E,S)}),g=[],_.forEach(d=>d()),_=[],p=!1,A=!1,C=!0,s?.call(u),u._resetInternal&&u._resetInternal()})},get renderFn(){return e},get el(){return i},get state(){return y}};u.ref=function(l){return this.el&&(this.el.querySelector(`[data-ref="${l}"]`)||this.el.querySelector(l))||null},u.refs=new Proxy({},{get(l,d){return u.ref(d)}}),u.action=function(l){return l.target.closest("[data-action]")?.dataset.action||null};function v(){_=[],Object.entries(t).forEach(([l,d])=>{if(l.includes("::")){let E=d.bind(u),S=H.subscribe(l,E);_.push(S)}})}function R(l){f=l,u.props=f;let d=u.render(f);if(d===null||d===""){!C&&i&&i.firstChild?(b=i.firstChild.cloneNode(!0),N(c,()=>{i.innerHTML="",g.forEach(({node:S,type:O,listener:W})=>{S.removeEventListener(O,W)}),g=[],p=!1,C=!0,s?.call(u)})):C=!0;return}if(C&&b){i.appendChild(b),b=null,C=!1,p=!0,L(u,i,t,g),r?.call(u);return}C=!1,B(i,d),L(u,i,t,g),p&&a&&a.call(u,m)}function N(l,d){l?l.length?l.call(u,d):Promise.resolve(l.call(u)).then(d):d()}function h(l={}){return h._render(l),h}return Object.assign(h,u),["el","props","state","setState"].forEach(l=>{Object.defineProperty(h,l,{get(){return u[l]},enumerable:!0})}),h._render=R,h.render=u.render,h._id=te++,h}function re(e,n,t=r=>r.id??r.key??r){return e.map((r,s)=>{let o=t(r,s),c=n(r,s);return typeof c=="string"?c.replace(/^<([a-zA-Z0-9-]+)/,`<$1 data-key="${String(o).replace(/"/g,"&quot;")}"`):c}).join("")}return Q(se);})();
//# sourceMappingURL=magnumjs-micro-ui.js.map
