/*!
 * @magnumjs/micro-ui v1.11.4
 * Author: Michael Glazer
 * Website: https://github.com/magnumjs/micro-ui#readme
 */
var MicroUI=(()=>{var V=Object.defineProperty;var re=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var ie=Object.prototype.hasOwnProperty;var se=(e,t)=>{for(var l in t)V(e,l,{get:t[l],enumerable:!0})},le=(e,t,l,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of oe(t))!ie.call(e,o)&&o!==l&&V(e,o,{get:()=>t[o],enumerable:!(n=re(t,o))||n.enumerable});return e};var ce=e=>le(V({},"__esModule",{value:!0}),e);var ye={};se(ye,{__VERSION__:()=>he,createComponent:()=>Z,getComponentById:()=>K,globalComponentRegistry:()=>O,registerComponent:()=>Q,unregisterComponent:()=>Y,useCurrentComponent:()=>pe});function R(e,t){if(!e)return!1;let l=document.createElement("div");if(l.innerHTML=t,l.children.length===0&&e.children.length===0&&l.textContent)return e.textContent!==l.textContent&&(e.textContent=l.textContent),!0;let n=Array.from(l.children),o=Array.from(e.children);n.length===1&&e.dataset.key&&!n[0]?.dataset.key&&(n[0].dataset.key=e.dataset.key);let u=new Map,a=new Map;for(let r of n){let s=r.dataset.key;s&&u.set(s,r)}for(let r of o){let s=r.dataset.key;s&&a.set(s,r)}let c=0;for(let r of n){let s=r.dataset.key,y=e.children[c];if(s&&a.has(s)){let _=a.get(s);_.hasAttribute("data-comp-root")||J(_,r),_!==y&&e.insertBefore(_,y||null),a.delete(s)}else e.insertBefore(r,y||null);c++}for(let r of a.values())r.hasAttribute("data-comp-root")||r.remove();for(;e.children.length>n.length;){let r=e.lastChild;if(r?.hasAttribute?.("data-comp-root"))break;r.remove()}return!0}function J(e,t){if(e.tagName!==t.tagName){e.replaceWith(t.cloneNode(!0));return}ae(e,t),!e.hasAttribute("data-comp-root")&&fe(e,t)}function ae(e,t){let l=e.attributes,n=t.attributes;for(let{name:o}of Array.from(l))t.hasAttribute(o)||e.removeAttribute(o);for(let{name:o,value:u}of Array.from(n))e.getAttribute(o)!==u&&e.setAttribute(o,u)}function fe(e,t){let l=Array.from(e.childNodes),n=Array.from(t.childNodes),o=Math.max(l.length,n.length);for(let u=0;u<o;u++){let a=l[u],c=n[u];if(!c&&a){if(a.nodeType===1&&a.hasAttribute("data-comp-root"))continue;e.removeChild(a);continue}if(!a&&c){e.appendChild(c.cloneNode(!0));continue}ue(a,c)}}function ue(e,t){if(!e.isEqualNode(t)){if(e.nodeType!==t.nodeType){e.replaceWith(t.cloneNode(!0));return}e.nodeType===Node.TEXT_NODE?e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue):e.nodeType===Node.ELEMENT_NODE&&e.tagName===t.tagName?J(e,t):e.replaceWith(t.cloneNode(!0))}}function U(e,t,l,n){if(!t||!t.children[0]||!l)return;let o=t.children.length>1?t:t.children[0];function u(c,r){for(let s=c;s&&s!==r.parentNode;s=s.parentElement)if(!(!s||!s.hasAttributes||!s.hasAttributes())){for(let y of s.attributes)if(y.name==="data-action"||y.name.startsWith("data-action-"))return s}return null}function a(c,r=!1){if(c&&!(!r&&c.hasAttribute&&c.hasAttribute("data-comp-root"))){Object.entries(l).forEach(([s,y])=>{let _=s.includes(":"),[B,H]=_?s.split(":"):s.split(" "),W=B==="*";(W?["click","input","change","keydown","submit"]:[B]).forEach(b=>{let h=v=>{let E=u(v.target,o),T="",M="";if(E){let A=`data-action-${v.type}`,d=`data-args-${v.type}`;T=E.getAttribute(A)??E.getAttribute("data-action")??"",M=E.getAttribute(d)??E.getAttribute("data-args")??""}let x=T.split(":"),S=x[0],P=[];if(M)try{let A=JSON.parse(M);P=Array.isArray(A)?A:[A]}catch{console.warn("Invalid JSON in data-args:",M)}else P=x.slice(1);let j={...v.target.dataset,event:v,state:e.state,setState:e.setState,props:e.props,refs:e.refs,action:S,args:P};if(_&&E&&(H==="*"||H===S)&&(W||v.type===B))return y.call(e,j);if(!_){let A=v.target.closest(H||"*");return A&&o.contains(A)?y.call(e,j):void 0}},k=`__microBound_${b}_${s}`;o[k]||(o.addEventListener(b,h),o[k]=!0,n.push({node:o,type:b,listener:h}))})});for(let s of c.children)a(s,!1)}}a(t,!0)}var X=new WeakMap;function L(e,t){if(!e)return null;if(!e.hasAttribute("data-comp-root"))throw new Error("ref() must be called with a component root element");let l=X.get(e);if(l||(l={},X.set(e,l)),l[t]){let a=l[t];if(a.isConnected&&e.contains(a))return a;delete l[t]}let n=e.querySelector(`[data-key="${t}"]`);if(n&&n._componentInstance)return l[t]=n._componentInstance,n._componentInstance;let o=[`[data-ref="${t}"]`,`[data-slot="${t}"]`,`slot[name="${t}"]`,"slot:not([name])",`${t}`,`#${t}`];function u(a,c){if(a===c)return!0;let r=a.closest("[data-comp-root]");return!r||r===c}for(let a of o){let c=null;try{let r=e.querySelectorAll(a);for(let s of r)if(u(s,e)){c=s;break}}catch{console.warn(`ref() invalid selector: ${a} for ref name ${t}`)}if(c)return l[t]=c,c}return null}var N=new WeakMap;function D(e,t,l){if(!e||t===null||N.has(e)&&N.get(e).value===t)return;let n=typeof t=="function"?t():t;if(e.nodeName==="SLOT"&&!e.hasAttribute("name")&&n&&typeof n=="object"&&"default"in n&&(n=n.default),Array.isArray(n)){let o=e.parentNode;if(!o)return;let u={};Array.from(o.children).forEach(c=>{let r=c.getAttribute&&c.getAttribute("data-key");r!=null&&(u[r]=c)});let a=[];n.forEach(c=>{let r=typeof c=="function"?c():c,s=null,y=r?.props?.key??(r?.el?.getAttribute&&r.el.getAttribute("data-key"));if(y!=null&&u[y])s=u[y],r&&typeof r.update=="function"&&r.update();else if(r&&typeof r.mount=="function"){let _=document.createElement("div");r.mount(_),s=r.el instanceof HTMLElement?r.el:_,l._mountedChildren.includes(r)||l._mountedChildren.push(r)}else if(r?.el instanceof HTMLElement)s=r.el;else if(r instanceof Node)s=r;else if(typeof r=="string"){let _=document.createElement("div");_.innerHTML=r,s=_.firstChild}s&&a.push(s)}),o.contains(e)&&o.removeChild(e),a.forEach((c,r)=>{o.children[r]!==c&&o.insertBefore(c,o.children[r]||null)}),Array.from(o.children).forEach(c=>{a.includes(c)||o.removeChild(c)}),N.set(e,{value:t});return}if(n&&typeof n.mount=="function"){if(n.isMounted())n.update(),n.el!==e&&e.replaceWith(n.el);else{let o=document.createElement("div");e.replaceWith(o),n.mount(o),n.el===e&&(n.el=o)}l._mountedChildren.includes(n)||l._mountedChildren.push(n)}else if(n?.el instanceof HTMLElement)e.replaceWith(n.el);else if(n instanceof Node)e.replaceWith(n);else if(typeof n=="string"){let o=document.createElement("div");o.innerHTML=n;let u=document.createDocumentFragment();for(;o.firstChild;)u.appendChild(o.firstChild);e.replaceWith(u)}else e.replaceWith(document.createTextNode(""));N.set(e,{value:t})}function z(e,t,l,n){let u={...typeof n=="function"?n.call(l,t):typeof n=="object"?n:{},...t.slots||{}};(typeof t.slots=="function"||Array.isArray(t.slots))&&(u={default:t.slots}),t.children!==void 0?u.default=t.children:u.default||(u.default=null),(e.el?.querySelectorAll("[data-comp]")||[]).forEach(c=>{let r=c.getAttribute("data-comp");if(!r)return;let s=K(+r);s&&(c.setAttribute("data-ref",r),u[r]||(s._fromSlotHydration=!0,u[r]=s({...s._prevProps,...c.dataset}),s._fromSlotHydration=!1))}),Object.entries(u).forEach(([c,r])=>{let s;if(c==="default"||c==="children"?s=e.el?.querySelector('[data-ref="children"]')||e.el?.querySelector("slot:not([name])"):s=L(e.el,c),!s||r==null)return;let y=s.querySelector("[data-comp-root='"+e._id+"']");!y&&r&&typeof r.mount=="function"&&(y=document.createElement("div"),y.setAttribute("data-comp-root",e._id),s.innerHTML="",s.appendChild(y));let _=y||s;r._id&&(r._fromSlotHydration=!0),D(_,r,l),r._id&&(r._fromSlotHydration=!1)})}function F(e,t){if(!t)return;t.querySelectorAll("*").forEach(n=>{Array.from(n.attributes).forEach(o=>{if(!o.name.startsWith("data-action-"))return;let u=o.name.slice(12),a=o.value;if(!a)return;let c=`${u}:${a}`;if(typeof e.on[c]!="function"){if(typeof e.on[a]=="function"){e.on[c]=e.on[a].bind(e);return}typeof e[a]=="function"&&(e.on[c]=e[a].bind(e))}})})}function w(e,t,l=!0,n){let o=t;for(let u of e)try{let a=u.call(n,o);a!==void 0&&(o=a)}catch(a){console.error(a)}return l&&(e.length=0),o}function q(e,t,l){if(Array.isArray(e)){let o=function(){if(n<e.length){let u=e[n++];try{u.length?u.call(l,o):Promise.resolve(u.call(l)).then(o).catch(a=>{console.error(a),o()})}catch(a){console.error(a),o()}}else t()},n=0;o()}else if(e)try{e.length?e.call(l,t):Promise.resolve(e.call(l)).then(t).catch(n=>{console.error(n),t()})}catch(n){console.error(n),t()}else t()}function G(e,t){for(let l of Object.keys(e))l in t||Object.defineProperty(t,l,{get(){return e[l]},enumerable:!0})}var de=1,he="1.11.4",O=new Map;function Q(e){e._id&&O.set(e._id,e)}function Y(e){e._id&&O.delete(e._id)}function K(e){return O.get(e)}var I=null;function me(e,t={}){let l=e._frozenTemplate,n=Z(l.renderFn,l.options);return n._initialProps=t,n._templateSource=e,n}function Z(e,t={}){let l=typeof e=="object"&&e!==null&&!Array.isArray(e),n=l?e.render:e,o=l?{...e,render:void 0}:{...t},{state:u={},on:a={},slots:c={},onMount:r,onUnmount:s,onBeforeMount:y,onBeforeUnmount:_,onUpdate:B,onBeforeRender:H,...W}=o,p=null,b=!1,h={},k={},v=null,E=!1,T=[],M=u,x=null,S=!1,P={...u},j=!1,A=i=>{M=typeof i=="function"?i(M):{...M,...i},j||(j=!0,v={...h},queueMicrotask(()=>{j=!1,f(v),v=null}))},d={refs:{},on(){},setState:A,props:h,_childCallCache:{},_childCallIndex:0,isMounted:()=>b,_renderIndex:0,_mountedChildren:[],_unmountCbs:[],_mountCbs:[],_beforeMountCbs:[],_updateCbs:[],_beforeUnmountCbs:[],_beforeRenderCbs:[],onMount(i){i&&this._mountCbs.push(i)},onUnmount(i){i&&this._unmountCbs.push(i)},onBeforeMount(i){i&&this._beforeMountCbs.push(i)},onBeforeUnmount(i){i&&this._beforeUnmountCbs.push(i)},onUpdate(i){i&&this._updateCbs.push(i)},onBeforeRender(i){i&&this._beforeRenderCbs.push(i)},addEvent(i,m){this.on[i]=m},mount(i,m={}){if(b||E)return;let g=typeof i=="string"?document.querySelector(i):i;if(!g)throw new Error(`No element matches: ${i}`);let C=()=>{E=!0,p=g,p.setAttribute("data-comp-root",f._id+"-"+(n.name||"")),h={...h,...m},k={...h},d.props=h,p._componentInstance=f,h.key&&p.setAttribute("data-key",h.key),f(h),S||(b=!0,w(d._mountCbs,void 0,!1,f))};q(d._beforeMountCbs,C,f)},update(i={}){if(!b)return;let m=i.props||i;m.on&&Object.assign(this.on,m.on),k={...h},h={...h,...m},d.props=h,h.key!==k.key&&p.setAttribute("data-key",h.key),f(h)},render(i={}){h={...h,...i},d.props=h;let m=typeof n=="function"?n.call(f,{state:M,setState:A,props:h,refs:d.refs}):n,g=w(d._beforeRenderCbs,m,!1,f);return g&&(g=new String(g),g._id=f._id),G(d,f),g},_resetInternal:()=>{d._mountedChildren.forEach(i=>{i&&typeof i.unmount=="function"&&i.unmount()}),d._mountedChildren=[],x=null,S=!1,p=null,b=!1,E=!1,T=[],h={},k={},M={...P}},unmount(){if(!b||!p)return;let i=()=>{p.firstChild&&(x=p.firstChild.cloneNode(!0),p.removeChild(p.firstChild)),w(d._unmountCbs,void 0,!0,f),T.forEach(({node:m,type:g,listener:C})=>{m.removeEventListener(g,C)}),T=[],b=!1,E=!1,S=!0,Y(f),d._resetInternal&&d._resetInternal()};q(d._beforeUnmountCbs,i,d)},get renderFn(){return n},get el(){return p},get state(){return M}};r&&d.onMount(r),s&&d.onUnmount(s),y&&d.onBeforeMount(y),_&&d.onBeforeUnmount(_),B&&d.onUpdate(B),H&&d.onBeforeRender(H),Object.assign(d.on,a),d.ref=function(i){return L(this.el,i)},d.refs=new Proxy({},{get(i,m){return d.ref(m)}});function ee(i){h={...d.props,...i},d.props=h,!p||p.isConnected;let m=d.render(h);if(m===null||m===""){!S&&p&&p.firstChild?(x=p.firstChild.cloneNode(!0),q(d._beforeUnmountCbs,()=>{p.innerHTML="",T.forEach(({node:C,type:te,listener:ne})=>{C.removeEventListener(te,ne)}),T=[],b=!1,S=!0,w(d._unmountCbs,void 0,!0,f)},d)):S=!0;return}if(S&&x){p.appendChild(x),x=null,S=!1,b=!0,U(f,p,f.on,T),w(d._mountCbs,void 0,!1,f);return}return R(p,m),z(f,h,d,c),F(f,p),U(f,p,f.on,T),b&&w(d._updateCbs,k,!1,f),S=!1,m}let $="";function f(i={}){if(!f._fromSlotHydration&&I&&I!==f){let m=I;m._childCallIndex==null&&(m._childCallIndex=0),m._childCallCache||(m._childCallCache={});let g=i.key!=null?i.key:m._childCallIndex++,C=m._childCallCache[g];return!C||C._templateSource!==f?(C=me(f,i),C._prevProps={...i},C.toString=()=>`<div data-comp="${C._id}"></div>`,m._childCallCache[g]=C):(C._prevProps={...i},C.update(i)),C}return I=f,f._renderIndex=0,f._childCallIndex=0,f._prevProps=i,$=f._render(i),I=null,f}return f.toString=function(){return!$||String($)===""&&!f.isMounted()&&I!==null&&I._id!==f._id?String(f._id):$?String($):""},Object.assign(f,d,W),["el","props","state","setState"].forEach(i=>{Object.defineProperty(f,i,{get(){return d[i]},enumerable:!0,configurable:!1})}),f._render=ee,f.render=d.render,f._id=de++,f.getId=()=>f._id,Q(f),f._frozenTemplate=Object.freeze({renderFn:n,options:{...o,state:{...P}}}),f}function pe(){return I}return ce(ye);})();
//# sourceMappingURL=magnumjs-micro-ui.js.map
