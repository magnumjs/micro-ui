/*!
 * @magnumjs/micro-ui v1.0.18
 * Author: Michael Glazer
 * Website: https://github.com/magnumjs/micro-ui#readme
 */
var MicroUI=(()=>{var P=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var Z=Object.getOwnPropertyNames;var k=Object.prototype.hasOwnProperty;var F=(e,n)=>{for(var t in n)P(e,t,{get:n[t],enumerable:!0})},G=(e,n,t,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of Z(n))!k.call(e,o)&&o!==t&&P(e,o,{get:()=>n[o],enumerable:!(r=X(n,o))||r.enumerable});return e};var Q=e=>G(P({},"__esModule",{value:!0}),e);var se={};F(se,{context:()=>N,createComponent:()=>ne,createState:()=>J,renderList:()=>re,shared:()=>K});function q(e,n={}){if(typeof e!="string")return"";let{children:t={},slots:r={}}=n;function o(i,s){let a;if(i)a=t?.[i]??r?.[i]??s;else if(t&&typeof t=="object"&&t.default!=null)a=t.default;else if(r&&typeof r=="object"&&r.default!=null)a=r.default;else if(typeof t=="string")a=t;else return s;if(typeof a=="function"&&(a=a()),a?.el instanceof HTMLElement)return a.el.outerHTML;if(a instanceof Node){let c=document.createElement("div");return c.appendChild(a.cloneNode(!0)),c.innerHTML}return a??s}return e=e.replace(/<slot(?:\s+name="([^"]+)")?>([\s\S]*?)<\/slot>/gis,(i,s,a)=>o(s,a)),e=e.replace(/<([a-z]+)([^>]*)\sdata-slot="([^"]+)"([^>]*)>([\s\S]*?)<\/\1>/gis,(i,s,a,c,p,f)=>{let m=o(c,f);return`<${s}${a}${p}>${m}</${s}>`}),e}function B(e,n){if(!e)return!1;let t=document.createElement("div");if(t.innerHTML=n,t.children.length===0&&t.textContent)return e.textContent=t.textContent,!0;let r=Array.from(t.children),o=Array.from(e.children),i=new Map,s=new Map;for(let c of r){let p=c.dataset.key;p&&i.set(p,c)}for(let c of o){let p=c.dataset.key;p&&s.set(p,c)}let a=0;for(let c of r){let p=c.dataset.key,f=e.children[a];if(p&&s.has(p)){let m=s.get(p);z(m,c),m!==f&&e.insertBefore(m,f||null),s.delete(p)}else e.insertBefore(c,f||null);a++}for(let c of s.values())c.remove();for(;e.children.length>r.length;)e.lastChild.remove();return!0}function z(e,n){if(e.tagName!==n.tagName){e.replaceWith(n.cloneNode(!0));return}Y(e,n),U(e,n)}function Y(e,n){let t=e.attributes,r=n.attributes;for(let{name:o}of Array.from(t))n.hasAttribute(o)||e.removeAttribute(o);for(let{name:o,value:i}of Array.from(r))e.getAttribute(o)!==i&&e.setAttribute(o,i)}function U(e,n){let t=Array.from(e.childNodes),r=Array.from(n.childNodes),o=Math.max(t.length,r.length);for(let i=0;i<o;i++){let s=t[i],a=r[i];if(!a&&s){e.removeChild(s);continue}if(!s&&a){e.appendChild(a.cloneNode(!0));continue}ee(s,a)}}function ee(e,n){if(!e.isEqualNode(n)){if(e.nodeType!==n.nodeType){e.replaceWith(n.cloneNode(!0));return}e.nodeType===Node.TEXT_NODE?e.nodeValue!==n.nodeValue&&(e.nodeValue=n.nodeValue):e.nodeType===Node.ELEMENT_NODE&&e.tagName===n.tagName?z(e,n):e.replaceWith(n.cloneNode(!0))}}function L(e,n,t,r){if(!n||!t)return;let o=n.firstElementChild;o&&Object.entries(t).forEach(([i,s])=>{let a=i.includes(":"),[c,p]=a?i.split(":"):i.split(" "),f=c==="*";(f?["click","input","change","keydown","submit"]:[c]).forEach(T=>{let A=y=>{let b=y.target.closest("[data-action]"),C=b?.dataset.action||"",M=b?.dataset.args,w=C.split(":"),_=w[0],x=[];if(M)try{let v=JSON.parse(M);x=Array.isArray(v)?v:[v]}catch{console.warn("Invalid JSON in data-args:",M)}else x=w.slice(1);let u={event:y,state:e.state,setState:e.setState,props:e.props,refs:e.refs,action:_,args:x};if(a&&b&&(p==="*"||p===_)&&(f||y.type===c))return s.call(e,u);if(!a){let v=y.target.closest(p||"*");if(v&&o.contains(v))return s.call(e,u)}},g=`__microBound_${T}_${i}`;o[g]||(o.addEventListener(T,A),o[g]=!0,r.push({node:o,type:T,listener:A}))})})}function J(e){let n=e,t=new Set;function r(s){n=typeof s=="function"?s(n):{...n,...s},t.forEach(a=>a(n))}function o(s){return t.add(s),s(n),()=>t.delete(s)}function i(){return n}return{get:i,setState:r,getState:i,subscribe:o}}var $=new Map,N={subscribe(e,n){$.has(e)||$.set(e,new Set);let t=$.get(e);return t.add(n),()=>t.delete(n)},emit(e,n){let t=$.get(e);if(t)for(let r of t)r(n)},clear(){$.clear()}},H=new Map;function K(e,n={}){if(!H.has(e)){let t=J(n),r={...t,emit(o,i){t.setState(i),N.emit(`${e}::${o}`,t.getState())},on(o,i){return N.subscribe(`${e}::${o}`,i)}};H.set(e,r)}return H.get(e)}K.clear=()=>H.clear();function V(e,n){if(!e||n==null)return;let t=typeof n=="function"?n():n;if(Array.isArray(t)){let r=document.createDocumentFragment();t.forEach(o=>{let i=typeof o=="function"?o():o;if(i&&typeof i.mount=="function"){let s=document.createElement("div");i.mount(s),s.firstElementChild&&r.appendChild(s.firstElementChild)}else if(i?.el instanceof HTMLElement)r.appendChild(i.el);else if(i instanceof Node)r.appendChild(i);else if(typeof i=="string"){let s=document.createElement("div");s.innerHTML=i,s.firstElementChild&&r.appendChild(s.firstElementChild)}}),e.replaceWith(r);return}if(t&&typeof t.mount=="function"){let r=document.createElement("div");e.replaceWith(r),t.mount(r)}else if(t?.el instanceof HTMLElement)e.replaceWith(t.el);else if(t instanceof Node)e.replaceWith(t);else if(typeof t=="string"){let r=document.createElement("div");r.innerHTML=t,r.firstElementChild&&e.replaceWith(r.firstElementChild)}else e.replaceWith(document.createTextNode(""))}var te=0;function ne(e,{state:n={},on:t={},onMount:r,onUnmount:o,onBeforeMount:i,onBeforeUnmount:s,onUpdate:a}={}){let c=null,p=!1,f={},m={},T=null,A=!1,g=[],y=n,b=null,C=!1,M={...n},w=!1,_=[],x=l=>{y=typeof l=="function"?l(y):{...y,...l},w||(w=!0,T={...f},queueMicrotask(()=>{w=!1,h(T),T=null}))},u={refs:{},setState:x,props:f,mount(l,d={}){if(p||A)return;let E=typeof l=="string"?document.querySelector(l):l;if(!E)throw new Error(`No element matches: ${l}`);j(i,()=>{A=!0,c=E,f={...f,...d},m={...f},u.props=f,h(f);let O={...f.slots||{},children:f.children};Object.entries(O).forEach(([W,D])=>{let I=h.refs[W];!I||D==null||V(I,D)}),L(u,c,t,g),C||(p=!0,r?.call(h),v())})},update(l={}){if(!p)return;let d=l.props?l.props:l,E=d.on;E&&E!==t&&(t=E);let S={...f,...d};m={...f},f=S,u.props=f,h(f)},render(l={}){f={...f,...l},u.props=f;let d=typeof e=="function"?e.call(u,{state:y,setState:x,props:f,refs:u.refs}):e;return d=q(d,f),d&&(d=new String(d),d._id=h._id),d},_resetInternal:()=>{b=null,C=!1,c=null,p=!1,A=!1,g=[],f={},m={},y={...M}},unmount(){if(!p||!c)return;j(s,()=>{c.firstChild&&(b=c.firstChild.cloneNode(!0),c.removeChild(c.firstChild)),g.forEach(({node:d,type:E,listener:S})=>{d.removeEventListener(E,S)}),g=[],_.forEach(d=>d()),_=[],p=!1,A=!1,C=!0,o?.call(u),u._resetInternal&&u._resetInternal()})},get renderFn(){return e},get el(){return c},get state(){return y}};u.ref=function(l){return this.el&&(this.el.querySelector(`[data-ref="${l}"]`)||this.el.querySelector(l))||null},u.refs=new Proxy({},{get(l,d){return u.ref(d)}}),u.action=function(l){return l.target.closest("[data-action]")?.dataset.action||null};function v(){_=[],Object.entries(t).forEach(([l,d])=>{if(l.includes("::")){let E=d.bind(u),S=N.subscribe(l,E);_.push(S)}})}function R(l){f=l,u.props=f;let d=u.render(f);if(d===null||d===""){!C&&c&&c.firstChild?(b=c.firstChild.cloneNode(!0),j(s,()=>{c.innerHTML="",g.forEach(({node:S,type:O,listener:W})=>{S.removeEventListener(O,W)}),g=[],p=!1,C=!0,o?.call(u)})):C=!0;return}if(C&&b){c.appendChild(b),b=null,C=!1,p=!0,L(u,c,t,g),r?.call(u);return}C=!1,B(c,d),L(u,c,t,g),p&&a&&a.call(u,m)}function j(l,d){l?l.length?l.call(u,d):Promise.resolve(l.call(u)).then(d):d()}function h(l={}){return h._render(l),h}return Object.assign(h,u),["el","props","state","setState"].forEach(l=>{Object.defineProperty(h,l,{get(){return u[l]},enumerable:!0})}),h._render=R,h.render=u.render,h._id=te++,h}function re(e,n,t=r=>r.id??r.key??r){return e.map((r,o)=>{let i=t(r,o),s=n(r,o);return typeof s=="string"?s.replace(/^<([a-zA-Z0-9-]+)/,`<$1 data-key="${String(i).replace(/"/g,"&quot;")}"`):s}).join("")}return Q(se);})();
//# sourceMappingURL=magnumjs-micro-ui.js.map
