/*!
 * @magnumjs/micro-ui v1.11.4
 * Author: Michael Glazer
 * Website: https://github.com/magnumjs/micro-ui#readme
 */
var MicroUI=(()=>{var z=Object.defineProperty;var le=Object.getOwnPropertyDescriptor;var fe=Object.getOwnPropertyNames;var de=Object.prototype.hasOwnProperty;var me=(e,t)=>{for(var r in t)z(e,r,{get:t[r],enumerable:!0})},he=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of fe(t))!de.call(e,o)&&o!==r&&z(e,o,{get:()=>t[o],enumerable:!(n=le(t,o))||n.enumerable});return e};var pe=e=>he(z({},"__esModule",{value:!0}),e);var Te={};me(Te,{__VERSION__:()=>ye,context:()=>U,createChannelMap:()=>F,createComponent:()=>oe,createState:()=>se,getComponentById:()=>Z,globalComponentRegistry:()=>R,registerComponent:()=>ne,renderList:()=>$e,shared:()=>ie,unregisterComponent:()=>re,useContext:()=>Se,useCurrentComponent:()=>g,useEffect:()=>we,useEmit:()=>xe,useEvent:()=>Me,useEvents:()=>Ie,useFetch:()=>Ee,useState:()=>ve});function K(e,t){if(!e)return!1;let r=document.createElement("div");if(r.innerHTML=t,r.children.length===0&&e.children.length===0&&r.textContent)return e.textContent!==r.textContent&&(e.textContent=r.textContent),!0;let n=Array.from(r.children),o=Array.from(e.children);n.length===1&&e.dataset.key&&!n[0]?.dataset.key&&(n[0].dataset.key=e.dataset.key);let u=new Map,s=new Map;for(let i of n){let a=i.dataset.key;a&&u.set(a,i)}for(let i of o){let a=i.dataset.key;a&&s.set(a,i)}let c=0;for(let i of n){let a=i.dataset.key,p=e.children[c];if(a&&s.has(a)){let _=s.get(a);_.hasAttribute("data-comp-root")||Y(_,i),_!==p&&e.insertBefore(_,p||null),s.delete(a)}else e.insertBefore(i,p||null);c++}for(let i of s.values())i.hasAttribute("data-comp-root")||i.remove();for(;e.children.length>n.length;){let i=e.lastChild;if(i?.hasAttribute?.("data-comp-root"))break;i.remove()}return!0}function Y(e,t){if(e.tagName!==t.tagName){e.replaceWith(t.cloneNode(!0));return}be(e,t),!e.hasAttribute("data-comp-root")&&_e(e,t)}function be(e,t){let r=e.attributes,n=t.attributes;for(let{name:o}of Array.from(r))t.hasAttribute(o)||e.removeAttribute(o);for(let{name:o,value:u}of Array.from(n))e.getAttribute(o)!==u&&e.setAttribute(o,u)}function _e(e,t){let r=Array.from(e.childNodes),n=Array.from(t.childNodes),o=Math.max(r.length,n.length);for(let u=0;u<o;u++){let s=r[u],c=n[u];if(!c&&s){if(s.nodeType===1&&s.hasAttribute("data-comp-root"))continue;e.removeChild(s);continue}if(!s&&c){e.appendChild(c.cloneNode(!0));continue}Ce(s,c)}}function Ce(e,t){if(!e.isEqualNode(t)){if(e.nodeType!==t.nodeType){e.replaceWith(t.cloneNode(!0));return}e.nodeType===Node.TEXT_NODE?e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue):e.nodeType===Node.ELEMENT_NODE&&e.tagName===t.tagName?Y(e,t):e.replaceWith(t.cloneNode(!0))}}function q(e,t,r,n){if(!t||!t.children[0]||!r)return;let o=t.children.length>1?t:t.children[0];function u(c,i){for(let a=c;a&&a!==i.parentNode;a=a.parentElement)if(!(!a||!a.hasAttributes||!a.hasAttributes())){for(let p of a.attributes)if(p.name==="data-action"||p.name.startsWith("data-action-"))return a}return null}function s(c,i=!1){if(c&&!(!i&&c.hasAttribute&&c.hasAttribute("data-comp-root"))){Object.entries(r).forEach(([a,p])=>{let _=a.includes(":"),[I,$]=_?a.split(":"):a.split(" "),H=I==="*";(H?["click","input","change","keydown","submit"]:[I]).forEach(y=>{let m=v=>{let w=u(v.target,o),k="",x="";if(w){let E=`data-action-${v.type}`,d=`data-args-${v.type}`;k=w.getAttribute(E)??w.getAttribute("data-action")??"",x=w.getAttribute(d)??w.getAttribute("data-args")??""}let M=k.split(":"),S=M[0],L=[];if(x)try{let E=JSON.parse(x);L=Array.isArray(E)?E:[E]}catch{console.warn("Invalid JSON in data-args:",x)}else L=M.slice(1);let P={...v.target.dataset,event:v,state:e.state,setState:e.setState,props:e.props,refs:e.refs,action:S,args:L};if(_&&w&&($==="*"||$===S)&&(H||v.type===I))return p.call(e,P);if(!_){let E=v.target.closest($||"*");return E&&o.contains(E)?p.call(e,P):void 0}},T=`__microBound_${y}_${a}`;o[T]||(o.addEventListener(y,m),o[T]=!0,n.push({node:o,type:y,listener:m}))})});for(let a of c.children)s(a,!1)}}s(t,!0)}var ee=new WeakMap;function O(e,t){if(!e)return null;if(!e.hasAttribute("data-comp-root"))throw new Error("ref() must be called with a component root element");let r=ee.get(e);if(r||(r={},ee.set(e,r)),r[t]){let s=r[t];if(s.isConnected&&e.contains(s))return s;delete r[t]}let n=e.querySelector(`[data-key="${t}"]`);if(n&&n._componentInstance)return r[t]=n._componentInstance,n._componentInstance;let o=[`[data-ref="${t}"]`,`[data-slot="${t}"]`,`slot[name="${t}"]`,"slot:not([name])",`${t}`,`#${t}`];function u(s,c){if(s===c)return!0;let i=s.closest("[data-comp-root]");return!i||i===c}for(let s of o){let c=null;try{let i=e.querySelectorAll(s);for(let a of i)if(u(a,e)){c=a;break}}catch{console.warn(`ref() invalid selector: ${s} for ref name ${t}`)}if(c)return r[t]=c,c}return null}var V=new WeakMap;function G(e,t,r){if(!e||t===null||V.has(e)&&V.get(e).value===t)return;let n=typeof t=="function"?t():t;if(e.nodeName==="SLOT"&&!e.hasAttribute("name")&&n&&typeof n=="object"&&"default"in n&&(n=n.default),Array.isArray(n)){let o=e.parentNode;if(!o)return;let u={};Array.from(o.children).forEach(c=>{let i=c.getAttribute&&c.getAttribute("data-key");i!=null&&(u[i]=c)});let s=[];n.forEach(c=>{let i=typeof c=="function"?c():c,a=null,p=i?.props?.key??(i?.el?.getAttribute&&i.el.getAttribute("data-key"));if(p!=null&&u[p])a=u[p],i&&typeof i.update=="function"&&i.update();else if(i&&typeof i.mount=="function"){let _=document.createElement("div");i.mount(_),a=i.el instanceof HTMLElement?i.el:_,r._mountedChildren.includes(i)||r._mountedChildren.push(i)}else if(i?.el instanceof HTMLElement)a=i.el;else if(i instanceof Node)a=i;else if(typeof i=="string"){let _=document.createElement("div");_.innerHTML=i,a=_.firstChild}a&&s.push(a)}),o.contains(e)&&o.removeChild(e),s.forEach((c,i)=>{o.children[i]!==c&&o.insertBefore(c,o.children[i]||null)}),Array.from(o.children).forEach(c=>{s.includes(c)||o.removeChild(c)}),V.set(e,{value:t});return}if(n&&typeof n.mount=="function"){if(n.isMounted())n.update(),n.el!==e&&e.replaceWith(n.el);else{let o=document.createElement("div");e.replaceWith(o),n.mount(o),n.el===e&&(n.el=o)}r._mountedChildren.includes(n)||r._mountedChildren.push(n)}else if(n?.el instanceof HTMLElement)e.replaceWith(n.el);else if(n instanceof Node)e.replaceWith(n);else if(typeof n=="string"){let o=document.createElement("div");o.innerHTML=n;let u=document.createDocumentFragment();for(;o.firstChild;)u.appendChild(o.firstChild);e.replaceWith(u)}else e.replaceWith(document.createTextNode(""));V.set(e,{value:t})}function J(e,t,r,n){let u={...typeof n=="function"?n.call(r,t):typeof n=="object"?n:{},...t.slots||{}};(typeof t.slots=="function"||Array.isArray(t.slots))&&(u={default:t.slots}),t.children!==void 0?u.default=t.children:u.default||(u.default=null),(e.el?.querySelectorAll("[data-comp]")||[]).forEach(c=>{let i=c.getAttribute("data-comp");if(!i)return;let a=Z(+i);a&&(c.setAttribute("data-ref",i),u[i]||(a._fromSlotHydration=!0,u[i]=a({...a._prevProps,...c.dataset}),a._fromSlotHydration=!1))}),Object.entries(u).forEach(([c,i])=>{let a;if(c==="default"||c==="children"?a=e.el?.querySelector('[data-ref="children"]')||e.el?.querySelector("slot:not([name])"):a=O(e.el,c),!a||i==null)return;let p=a.querySelector("[data-comp-root='"+e._id+"']");!p&&i&&typeof i.mount=="function"&&(p=document.createElement("div"),p.setAttribute("data-comp-root",e._id),a.innerHTML="",a.appendChild(p));let _=p||a;i._id&&(i._fromSlotHydration=!0),G(_,i,r),i._id&&(i._fromSlotHydration=!1)})}function X(e,t){if(!t)return;t.querySelectorAll("*").forEach(n=>{Array.from(n.attributes).forEach(o=>{if(!o.name.startsWith("data-action-"))return;let u=o.name.slice(12),s=o.value;if(!s)return;let c=`${u}:${s}`;if(typeof e.on[c]!="function"){if(typeof e.on[s]=="function"){e.on[c]=e.on[s].bind(e);return}typeof e[s]=="function"&&(e.on[c]=e[s].bind(e))}})})}function j(e,t,r=!0,n){let o=t;for(let u of e)try{let s=u.call(n,o);s!==void 0&&(o=s)}catch(s){console.error(s)}return r&&(e.length=0),o}function N(e,t,r){if(Array.isArray(e)){let o=function(){if(n<e.length){let u=e[n++];try{u.length?u.call(r,o):Promise.resolve(u.call(r)).then(o).catch(s=>{console.error(s),o()})}catch(s){console.error(s),o()}}else t()},n=0;o()}else if(e)try{e.length?e.call(r,t):Promise.resolve(e.call(r)).then(t).catch(n=>{console.error(n),t()})}catch(n){console.error(n),t()}else t()}function te(e,t){for(let r of Object.keys(e))r in t||Object.defineProperty(t,r,{get(){return e[r]},enumerable:!0})}var ge=1,ye="1.11.4",R=new Map;function ne(e){e._id&&R.set(e._id,e)}function re(e){e._id&&R.delete(e._id)}function Z(e){return R.get(e)}var B=null;function Ae(e,t={}){let r=e._frozenTemplate,n=oe(r.renderFn,r.options);return n._initialProps=t,n._templateSource=e,n}function oe(e,t={}){let r=typeof e=="object"&&e!==null&&!Array.isArray(e),n=r?e.render:e,o=r?{...e,render:void 0}:{...t},{state:u={},on:s={},slots:c={},onMount:i,onUnmount:a,onBeforeMount:p,onBeforeUnmount:_,onUpdate:I,onBeforeRender:$,...H}=o,b=null,y=!1,m={},T={},v=null,w=!1,k=[],x=u,M=null,S=!1,L={...u},P=!1,E=l=>{x=typeof l=="function"?l(x):{...x,...l},P||(P=!0,v={...m},queueMicrotask(()=>{P=!1,f(v),v=null}))},d={refs:{},on(){},setState:E,props:m,_childCallCache:{},_childCallIndex:0,isMounted:()=>y,_renderIndex:0,_mountedChildren:[],_unmountCbs:[],_mountCbs:[],_beforeMountCbs:[],_updateCbs:[],_beforeUnmountCbs:[],_beforeRenderCbs:[],onMount(l){l&&this._mountCbs.push(l)},onUnmount(l){l&&this._unmountCbs.push(l)},onBeforeMount(l){l&&this._beforeMountCbs.push(l)},onBeforeUnmount(l){l&&this._beforeUnmountCbs.push(l)},onUpdate(l){l&&this._updateCbs.push(l)},onBeforeRender(l){l&&this._beforeRenderCbs.push(l)},addEvent(l,h){this.on[l]=h},mount(l,h={}){if(y||w)return;let A=typeof l=="string"?document.querySelector(l):l;if(!A)throw new Error(`No element matches: ${l}`);let C=()=>{w=!0,b=A,b.setAttribute("data-comp-root",f._id+"-"+(n.name||"")),m={...m,...h},T={...m},d.props=m,b._componentInstance=f,m.key&&b.setAttribute("data-key",m.key),f(m),S||(y=!0,j(d._mountCbs,void 0,!1,f))};N(d._beforeMountCbs,C,f)},update(l={}){if(!y)return;let h=l.props||l;h.on&&Object.assign(this.on,h.on),T={...m},m={...m,...h},d.props=m,m.key!==T.key&&b.setAttribute("data-key",m.key),f(m)},render(l={}){m={...m,...l},d.props=m;let h=typeof n=="function"?n.call(f,{state:x,setState:E,props:m,refs:d.refs}):n,A=j(d._beforeRenderCbs,h,!1,f);return A&&(A=new String(A),A._id=f._id),te(d,f),A},_resetInternal:()=>{d._mountedChildren.forEach(l=>{l&&typeof l.unmount=="function"&&l.unmount()}),d._mountedChildren=[],M=null,S=!1,b=null,y=!1,w=!1,k=[],m={},T={},x={...L}},unmount(){if(!y||!b)return;let l=()=>{b.firstChild&&(M=b.firstChild.cloneNode(!0),b.removeChild(b.firstChild)),j(d._unmountCbs,void 0,!0,f),k.forEach(({node:h,type:A,listener:C})=>{h.removeEventListener(A,C)}),k=[],y=!1,w=!1,S=!0,re(f),d._resetInternal&&d._resetInternal()};N(d._beforeUnmountCbs,l,d)},get renderFn(){return n},get el(){return b},get state(){return x}};i&&d.onMount(i),a&&d.onUnmount(a),p&&d.onBeforeMount(p),_&&d.onBeforeUnmount(_),I&&d.onUpdate(I),$&&d.onBeforeRender($),Object.assign(d.on,s),d.ref=function(l){return O(this.el,l)},d.refs=new Proxy({},{get(l,h){return d.ref(h)}});function ce(l){m={...d.props,...l},d.props=m,!b||b.isConnected;let h=d.render(m);if(h===null||h===""){!S&&b&&b.firstChild?(M=b.firstChild.cloneNode(!0),N(d._beforeUnmountCbs,()=>{b.innerHTML="",k.forEach(({node:C,type:ue,listener:ae})=>{C.removeEventListener(ue,ae)}),k=[],y=!1,S=!0,j(d._unmountCbs,void 0,!0,f)},d)):S=!0;return}if(S&&M){b.appendChild(M),M=null,S=!1,y=!0,q(f,b,f.on,k),j(d._mountCbs,void 0,!1,f);return}return K(b,h),J(f,m,d,c),X(f,b),q(f,b,f.on,k),y&&j(d._updateCbs,T,!1,f),S=!1,h}let W="";function f(l={}){if(!f._fromSlotHydration&&B&&B!==f){let h=B;h._childCallIndex==null&&(h._childCallIndex=0),h._childCallCache||(h._childCallCache={});let A=l.key!=null?l.key:h._childCallIndex++,C=h._childCallCache[A];return!C||C._templateSource!==f?(C=Ae(f,l),C._prevProps={...l},C.toString=()=>`<div data-comp="${C._id}"></div>`,h._childCallCache[A]=C):(C._prevProps={...l},C.update(l)),C}return B=f,f._renderIndex=0,f._childCallIndex=0,f._prevProps=l,W=f._render(l),B=null,f}return f.toString=function(){return!W||String(W)===""&&!f.isMounted()&&B!==null&&B._id!==f._id?String(f._id):W?String(W):""},Object.assign(f,d,H),["el","props","state","setState"].forEach(l=>{Object.defineProperty(f,l,{get(){return d[l]},enumerable:!0,configurable:!1})}),f._render=ce,f.render=d.render,f._id=ge++,f.getId=()=>f._id,ne(f),f._frozenTemplate=Object.freeze({renderFn:n,options:{...o,state:{...L}}}),f}function g(){return B}function Ee(e,t={}){let r=g();if(!r)throw new Error("useFetch must be called inside a component render or lifecycle");(!r.state||r.state.data===void 0&&r.state.loading===void 0&&r.state.error===void 0)&&r.setState({data:null,loading:!0,error:null});async function n(){r.setState(o=>({...o,loading:!0}));try{let u=await(await fetch(e,t)).json();r.setState({data:u,error:null,loading:!1}),r.emit&&r.emit("fetch::done",{url:e,data:u})}catch(o){r.setState({data:null,error:o,loading:!1}),r.emit&&r.emit("fetch::error",{url:e,error:o})}}return r.onMount(n),r.onEmit&&r.onEmit("fetch::refresh",n),{get:()=>({...r.state}),subscribe:o=>(r.onUpdate(()=>o({...r.state})),()=>{}),refresh:n}}var Q={};function Se(e,t={}){let r=g();if(!r)throw new Error("useContext() must be inside render()");Q[e]||(Q[e]={value:t,subs:new Set});let n=Q[e];n.subs.add(r),r.onUnmount(()=>n.subs.delete(r));let o=u=>{n.value=typeof u=="function"?u(n.value):u,n.subs.forEach(s=>s.update())};return[n.value,o]}function ve(e){let t=g();if(!t)throw new Error("useState must be inside render()");t._hasStateSetters||(t.state&&Object.keys(t.state).forEach(o=>{let u="set"+o.charAt(0).toUpperCase()+o.slice(1);t[u]||(t[u]=s=>{let c=t.state[o],i=typeof s=="function"?s(c):s;i!==c&&(t.state[o]=i,t.update())})}),t._hasStateSetters=!0);let r=t._renderIndex++;t._hooks||(t._hooks=[]),t._hooks[r]===void 0&&(t._hooks[r]=typeof e=="function"?e():e);let n=o=>{let u=t._hooks[r],s=typeof o=="function"?o(u):o;s!==u&&(t._hooks[r]=s,t.update())};return[t._hooks[r],n]}function we(e,t=[]){let r=g();if(!r)throw new Error("useEffect must be inside render()");let n=r._renderIndex++;r._hooks=r._hooks||[];let o=r._hooks[n]||[];if(t.length===0||t.some((s,c)=>s!==o[c])){let s;r.onUnmount(()=>s&&s()),s=e(),r._hooks[n]=t}}function F(){let e=new Map;return{subscribe(t,r){e.has(t)||e.set(t,new Set);let n=e.get(t);return n.add(r),()=>n.delete(r)},emit(t,r){let n=e.get(t);if(n)for(let o of n)o(r)},clear(){e.clear()}}}function se(e){let t=e,r=new Set;function n(s){typeof t=="object"&&t!==null&&typeof s=="object"&&s!==null&&!Array.isArray(t)&&!Array.isArray(s)?t={...t,...s}:t=typeof s=="function"?s(t):s,r.forEach(c=>c(t))}function o(s){return r.add(s),s(t),()=>r.delete(s)}function u(){return t}return{get:u,setState:n,getState:u,subscribe:o}}var U=F(),D=new Map;function ie(e,t={}){if(!D.has(e)){let r=se(t),n={...r,emit(o,u){r.setState(u),U.emit(`${e}::${o}`,r.getState())},on(o,u){return U.subscribe(`${e}::${o}`,u)}};D.set(e,n)}return D.get(e)}ie.clear=()=>D.clear();function xe(){let e=g();if(!e)throw new Error("useEmit must be inside render()");if(e._hasEmits)return e._emitsApi;e._hasEmits=!0;let t=F(),r={emit:(n,o)=>t.emit(n,o),onEmit:(n,o)=>{let u=t.subscribe(n,o);return e.onUnmount(u),u},emitGlobal:(n,o)=>U.emit(n,o),onEmitGlobal:(n,o)=>{let u=U.subscribe(n,o);return e.onUnmount(u),u}};return Object.assign(e,r),e._emitsApi=r,e.onBeforeRender(function(){ke(e,e.on)}),e.onUnmount(()=>{t.clear()}),r}function ke(e,t={}){let r=[];Object.entries(t).forEach(([n,o])=>{if(n.includes("::")){let u=o.bind(e),s=U.subscribe(n,u);r.push(s)}else!n.includes(" ")&&!n.includes("*")&&!n.includes(":")&&e.onEmit(n,o.bind(e))}),e.onUnmount(()=>{r.forEach(n=>n()),r=[]})}function Me(){let e=g();if(!e)throw new Error("useEvent must be inside render()");e._eventApi&&e._eventApi;function t(u){let s={on(c,i){return e.addEvent(`${c} [data-ref=${u}]`,i),s},onClick(c){return this.on("click",c)},onBlur(c){return this.on("blur",c)},onInput(c){return this.on("input",c)},onChange(c){return this.on("change",c)},onFocus(c){return this.on("focus",c)},onSubmit(c){return this.on("submit",c)},toString(){return`data-ref="${u}"`}};return s}function r(u){return s=>{let c=`h${e._renderIndex++}`;return e.addEvent(`${u} [data-ref=${c}]`,s),t(c)}}let n={onClick:r("click"),onBlur:r("blur"),onInput:r("input"),onChange:r("change"),onFocus:r("focus"),onSubmit:r("submit"),on:(u,s)=>r(u)(s)},o={...e.on};return e.prototype.on=n.on,Object.assign(e.on,o),e._eventApi=n,n}function Ie(){let e=g();if(!e)throw new Error("useEvent must be inside render()");function t(c){return c.replace(/<([a-zA-Z0-9-]+)([^>]*?)>/gs,(i,a,p)=>{let _=[...p.matchAll(/data-ref="([^"]+)"/g)].map(H=>H[1]);if(_.length<=1)return i;let I=`data-ref="${_.join(" ")}"`,$=p.replace(/\s*data-ref="[^"]*"/g,"");return`<${a} ${I}${$}>`})}e.onBeforeRender(t);let r={...e.on},n=["click","dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","keydown","keyup","keypress","input","change","focus","blur","submit","contextmenu","wheel","touchstart","touchend","touchmove"];e.on=function(i,a){if(i&&a)return n.includes(i)?o(i,a):(e.addEvent(i,a),"")},Object.assign(e.on,r);function o(c,i){let a=`h${e._renderIndex++}`;return e.addEvent(`${c} [data-ref~=${a}]`,i),`data-ref="${a}"`}function u(c){return i=>o(c,i)}let s={};return n.forEach(c=>{let i="on"+c.charAt(0).toUpperCase()+c.slice(1);s[i]=u(c)}),s}function $e(e,t,r=n=>n.id??n.key??n){return e.map((n,o)=>{let u=r(n,o),s=t(n,o);return typeof s=="string"?s.replace(/^<([a-zA-Z0-9-]+)/,`<$1 data-key="${String(u).replace(/"/g,"&quot;")}"`):s}).join("")}return pe(Te);})();
//# sourceMappingURL=magnumjs-micro-ui.all.js.map
