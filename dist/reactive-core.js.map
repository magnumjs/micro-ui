{
  "version": 3,
  "sources": ["../lib/reactive-core.js"],
  "sourcesContent": ["export function createState(initial) {\n  let state = initial;\n  const subs = new Set();\n\n  function setState(next) {\n    state = typeof next === 'function' ? next(state) : { ...state, ...next };\n    subs.forEach((fn) => fn(state));\n  }\n\n  function subscribe(fn) {\n    subs.add(fn);\n    fn(state);\n    return () => subs.delete(fn);\n  }\n\n  function get() {\n    return state;\n  }\n\n  return { get, setState, subscribe };\n}\n\nexport function createComponent(renderFn, { onMount, onDestroy, events = {} } = {}) {\n  let el = null;\n  let mounted = false;\n  let props = {};\n  let lastHTML = '';\n\n  const api = {\n    mount(target) {\n      if (mounted) return;\n      el = target;\n      mounted = true;\n      render(props);\n      onMount?.call(api);\n    },\n\n    mountTo(selector) {\n      const target = document.querySelector(selector);\n      if (!target) throw new Error(`No element matches selector: ${selector}`);\n      api.mount(target);\n    },\n\n    update(nextProps = {}) {\n      if (!mounted) return;\n      const changed = Object.keys(nextProps).some(\n        (key) => nextProps[key] !== props[key]\n      );\n      if (changed) {\n        props = { ...props, ...nextProps };\n        render(props);\n      }\n    },\n\n    render(newProps = {}) {\n      props = { ...props, ...newProps };\n      return typeof renderFn === 'function' ? renderFn(props) : renderFn;\n    },\n\n     get renderFn() {\n      return renderFn;\n    },\n    destroy() {\n      if (!mounted || !el) return;\n      onDestroy?.call(api);\n      el.innerHTML = '';\n      mounted = false;\n    },\n\n    get el() {\n      return el;\n    },\n\n    get props() {\n      return props;\n    },\n  };\n\n  function render(currentProps) {\n    props = currentProps;\n    const html = api.render(props);\n    const replaced = diffHTML(html);\n    bindEvents(replaced);\n  }\n\n  function diffHTML(newHTML) {\n    if (!el) return false;\n\n    const temp = document.createElement('div');\n    temp.innerHTML = newHTML;\n\n    const newChildren = Array.from(temp.children);\n    const oldChildren = Array.from(el.children);\n\n    const newKeys = newChildren.map((child) => child.dataset.key);\n    const oldKeyMap = new Map(oldChildren.map((child) => [child.dataset.key, child]));\n\n    // Clear container\n    el.innerHTML = '';\n\n    for (const newChild of newChildren) {\n      const key = newChild.dataset.key;\n      if (key && oldKeyMap.has(key)) {\n        const existing = oldKeyMap.get(key);\n        existing.innerHTML = newChild.innerHTML; // shallow update\n        el.appendChild(existing);\n      } else {\n        el.appendChild(newChild);\n      }\n    }\n\n    return true;\n  }\n\nfunction bindEvents() {\n  if (!el || !events) return;\n\n  const root = el.firstElementChild;\n  if (!root) return;\n\n  Object.entries(events).forEach(([key, handler]) => {\n    const [eventType, selector] = key.split(' ');\n    if (!eventType) return;\n\n    // Remove existing bound\n    if (handler._bound) {\n      root.removeEventListener(eventType, handler._bound);\n    }\n\n    const bound = (e) => {\n      const match = selector ? e.target.closest(selector) : e.target;\n      if (match && root.contains(match)) {\n        console.log(`[reactive-core] Event triggered: ${eventType} on`, match);\n        handler.call(api, e);\n      }\n    };\n\n    handler._bound = bound;\n    root.addEventListener(eventType, bound);\n  });\n}\n\n\n  return api;\n}\n\nexport function renderList(array, renderFn, keyFn = (item) => item.id ?? item.key ?? item) {\n  return array\n    .map((item, index) => {\n      const key = keyFn(item, index);\n      return `<div data-key=\"${key}\">${renderFn(item, index)}</div>`;\n    })\n    .join('');\n}\n"],
  "mappings": "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",
  "names": ["createState", "initial", "state", "subs", "setState", "next", "fn", "subscribe", "get", "createComponent", "renderFn", "onMount", "onDestroy", "events", "el", "mounted", "props", "lastHTML", "api", "target", "render", "selector", "nextProps", "key", "newProps", "currentProps", "html", "replaced", "diffHTML", "bindEvents", "newHTML", "temp", "newChildren", "oldChildren", "newKeys", "child", "oldKeyMap", "newChild", "existing", "root", "handler", "eventType", "bound", "e", "match", "renderList", "array", "keyFn", "item", "index"]
}
