/*!
 * @magnumjs/micro-ui v1.11.4
 * Author: Michael Glazer
 * Website: https://github.com/magnumjs/micro-ui#readme
 */
var MicroUIHooks=(()=>{var F=Object.defineProperty;var ue=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var le=Object.prototype.hasOwnProperty;var fe=(e,t)=>{for(var n in t)F(e,n,{get:t[n],enumerable:!0})},de=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ae(t))!le.call(e,o)&&o!==n&&F(e,o,{get:()=>t[o],enumerable:!(r=ue(t,o))||r.enumerable});return e};var me=e=>de(F({},"__esModule",{value:!0}),e);var $e={};fe($e,{__VERSION__:()=>Ce,createComponent:()=>oe,getComponentById:()=>J,globalComponentRegistry:()=>R,registerComponent:()=>ne,unregisterComponent:()=>re,useContext:()=>Ae,useCurrentComponent:()=>g,useEffect:()=>Se,useEmit:()=>xe,useEvent:()=>Me,useEvents:()=>Ie,useFetch:()=>ye,useState:()=>Ee});function z(e,t){if(!e)return!1;let n=document.createElement("div");if(n.innerHTML=t,n.children.length===0&&e.children.length===0&&n.textContent)return e.textContent!==n.textContent&&(e.textContent=n.textContent),!0;let r=Array.from(n.children),o=Array.from(e.children);r.length===1&&e.dataset.key&&!r[0]?.dataset.key&&(r[0].dataset.key=e.dataset.key);let u=new Map,s=new Map;for(let i of r){let a=i.dataset.key;a&&u.set(a,i)}for(let i of o){let a=i.dataset.key;a&&s.set(a,i)}let c=0;for(let i of r){let a=i.dataset.key,p=e.children[c];if(a&&s.has(a)){let _=s.get(a);_.hasAttribute("data-comp-root")||Y(_,i),_!==p&&e.insertBefore(_,p||null),s.delete(a)}else e.insertBefore(i,p||null);c++}for(let i of s.values())i.hasAttribute("data-comp-root")||i.remove();for(;e.children.length>r.length;){let i=e.lastChild;if(i?.hasAttribute?.("data-comp-root"))break;i.remove()}return!0}function Y(e,t){if(e.tagName!==t.tagName){e.replaceWith(t.cloneNode(!0));return}he(e,t),!e.hasAttribute("data-comp-root")&&pe(e,t)}function he(e,t){let n=e.attributes,r=t.attributes;for(let{name:o}of Array.from(n))t.hasAttribute(o)||e.removeAttribute(o);for(let{name:o,value:u}of Array.from(r))e.getAttribute(o)!==u&&e.setAttribute(o,u)}function pe(e,t){let n=Array.from(e.childNodes),r=Array.from(t.childNodes),o=Math.max(n.length,r.length);for(let u=0;u<o;u++){let s=n[u],c=r[u];if(!c&&s){if(s.nodeType===1&&s.hasAttribute("data-comp-root"))continue;e.removeChild(s);continue}if(!s&&c){e.appendChild(c.cloneNode(!0));continue}be(s,c)}}function be(e,t){if(!e.isEqualNode(t)){if(e.nodeType!==t.nodeType){e.replaceWith(t.cloneNode(!0));return}e.nodeType===Node.TEXT_NODE?e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue):e.nodeType===Node.ELEMENT_NODE&&e.tagName===t.tagName?Y(e,t):e.replaceWith(t.cloneNode(!0))}}function V(e,t,n,r){if(!t||!t.children[0]||!n)return;let o=t.children.length>1?t:t.children[0];function u(c,i){for(let a=c;a&&a!==i.parentNode;a=a.parentElement)if(!(!a||!a.hasAttributes||!a.hasAttributes())){for(let p of a.attributes)if(p.name==="data-action"||p.name.startsWith("data-action-"))return a}return null}function s(c,i=!1){if(c&&!(!i&&c.hasAttribute&&c.hasAttribute("data-comp-root"))){Object.entries(n).forEach(([a,p])=>{let _=a.includes(":"),[I,$]=_?a.split(":"):a.split(" "),U=I==="*";(U?["click","input","change","keydown","submit"]:[I]).forEach(y=>{let m=v=>{let w=u(v.target,o),k="",x="";if(w){let E=`data-action-${v.type}`,d=`data-args-${v.type}`;k=w.getAttribute(E)??w.getAttribute("data-action")??"",x=w.getAttribute(d)??w.getAttribute("data-args")??""}let M=k.split(":"),S=M[0],H=[];if(x)try{let E=JSON.parse(x);H=Array.isArray(E)?E:[E]}catch{console.warn("Invalid JSON in data-args:",x)}else H=M.slice(1);let P={...v.target.dataset,event:v,state:e.state,setState:e.setState,props:e.props,refs:e.refs,action:S,args:H};if(_&&w&&($==="*"||$===S)&&(U||v.type===I))return p.call(e,P);if(!_){let E=v.target.closest($||"*");return E&&o.contains(E)?p.call(e,P):void 0}},T=`__microBound_${y}_${a}`;o[T]||(o.addEventListener(y,m),o[T]=!0,r.push({node:o,type:y,listener:m}))})});for(let a of c.children)s(a,!1)}}s(t,!0)}var ee=new WeakMap;function O(e,t){if(!e)return null;if(!e.hasAttribute("data-comp-root"))throw new Error("ref() must be called with a component root element");let n=ee.get(e);if(n||(n={},ee.set(e,n)),n[t]){let s=n[t];if(s.isConnected&&e.contains(s))return s;delete n[t]}let r=e.querySelector(`[data-key="${t}"]`);if(r&&r._componentInstance)return n[t]=r._componentInstance,r._componentInstance;let o=[`[data-ref="${t}"]`,`[data-slot="${t}"]`,`slot[name="${t}"]`,"slot:not([name])",`${t}`,`#${t}`];function u(s,c){if(s===c)return!0;let i=s.closest("[data-comp-root]");return!i||i===c}for(let s of o){let c=null;try{let i=e.querySelectorAll(s);for(let a of i)if(u(a,e)){c=a;break}}catch{console.warn(`ref() invalid selector: ${s} for ref name ${t}`)}if(c)return n[t]=c,c}return null}var q=new WeakMap;function K(e,t,n){if(!e||t===null||q.has(e)&&q.get(e).value===t)return;let r=typeof t=="function"?t():t;if(e.nodeName==="SLOT"&&!e.hasAttribute("name")&&r&&typeof r=="object"&&"default"in r&&(r=r.default),Array.isArray(r)){let o=e.parentNode;if(!o)return;let u={};Array.from(o.children).forEach(c=>{let i=c.getAttribute&&c.getAttribute("data-key");i!=null&&(u[i]=c)});let s=[];r.forEach(c=>{let i=typeof c=="function"?c():c,a=null,p=i?.props?.key??(i?.el?.getAttribute&&i.el.getAttribute("data-key"));if(p!=null&&u[p])a=u[p],i&&typeof i.update=="function"&&i.update();else if(i&&typeof i.mount=="function"){let _=document.createElement("div");i.mount(_),a=i.el instanceof HTMLElement?i.el:_,n._mountedChildren.includes(i)||n._mountedChildren.push(i)}else if(i?.el instanceof HTMLElement)a=i.el;else if(i instanceof Node)a=i;else if(typeof i=="string"){let _=document.createElement("div");_.innerHTML=i,a=_.firstChild}a&&s.push(a)}),o.contains(e)&&o.removeChild(e),s.forEach((c,i)=>{o.children[i]!==c&&o.insertBefore(c,o.children[i]||null)}),Array.from(o.children).forEach(c=>{s.includes(c)||o.removeChild(c)}),q.set(e,{value:t});return}if(r&&typeof r.mount=="function"){if(r.isMounted())r.update(),r.el!==e&&e.replaceWith(r.el);else{let o=document.createElement("div");e.replaceWith(o),r.mount(o),r.el===e&&(r.el=o)}n._mountedChildren.includes(r)||n._mountedChildren.push(r)}else if(r?.el instanceof HTMLElement)e.replaceWith(r.el);else if(r instanceof Node)e.replaceWith(r);else if(typeof r=="string"){let o=document.createElement("div");o.innerHTML=r;let u=document.createDocumentFragment();for(;o.firstChild;)u.appendChild(o.firstChild);e.replaceWith(u)}else e.replaceWith(document.createTextNode(""));q.set(e,{value:t})}function G(e,t,n,r){let u={...typeof r=="function"?r.call(n,t):typeof r=="object"?r:{},...t.slots||{}};(typeof t.slots=="function"||Array.isArray(t.slots))&&(u={default:t.slots}),t.children!==void 0?u.default=t.children:u.default||(u.default=null),(e.el?.querySelectorAll("[data-comp]")||[]).forEach(c=>{let i=c.getAttribute("data-comp");if(!i)return;let a=J(+i);a&&(c.setAttribute("data-ref",i),u[i]||(a._fromSlotHydration=!0,u[i]=a({...a._prevProps,...c.dataset}),a._fromSlotHydration=!1))}),Object.entries(u).forEach(([c,i])=>{let a;if(c==="default"||c==="children"?a=e.el?.querySelector('[data-ref="children"]')||e.el?.querySelector("slot:not([name])"):a=O(e.el,c),!a||i==null)return;let p=a.querySelector("[data-comp-root='"+e._id+"']");!p&&i&&typeof i.mount=="function"&&(p=document.createElement("div"),p.setAttribute("data-comp-root",e._id),a.innerHTML="",a.appendChild(p));let _=p||a;i._id&&(i._fromSlotHydration=!0),K(_,i,n),i._id&&(i._fromSlotHydration=!1)})}function X(e,t){if(!t)return;t.querySelectorAll("*").forEach(r=>{Array.from(r.attributes).forEach(o=>{if(!o.name.startsWith("data-action-"))return;let u=o.name.slice(12),s=o.value;if(!s)return;let c=`${u}:${s}`;if(typeof e.on[c]!="function"){if(typeof e.on[s]=="function"){e.on[c]=e.on[s].bind(e);return}typeof e[s]=="function"&&(e.on[c]=e[s].bind(e))}})})}function j(e,t,n=!0,r){let o=t;for(let u of e)try{let s=u.call(r,o);s!==void 0&&(o=s)}catch(s){console.error(s)}return n&&(e.length=0),o}function N(e,t,n){if(Array.isArray(e)){let o=function(){if(r<e.length){let u=e[r++];try{u.length?u.call(n,o):Promise.resolve(u.call(n)).then(o).catch(s=>{console.error(s),o()})}catch(s){console.error(s),o()}}else t()},r=0;o()}else if(e)try{e.length?e.call(n,t):Promise.resolve(e.call(n)).then(t).catch(r=>{console.error(r),t()})}catch(r){console.error(r),t()}else t()}function te(e,t){for(let n of Object.keys(e))n in t||Object.defineProperty(t,n,{get(){return e[n]},enumerable:!0})}var _e=1,Ce="1.11.4",R=new Map;function ne(e){e._id&&R.set(e._id,e)}function re(e){e._id&&R.delete(e._id)}function J(e){return R.get(e)}var B=null;function ge(e,t={}){let n=e._frozenTemplate,r=oe(n.renderFn,n.options);return r._initialProps=t,r._templateSource=e,r}function oe(e,t={}){let n=typeof e=="object"&&e!==null&&!Array.isArray(e),r=n?e.render:e,o=n?{...e,render:void 0}:{...t},{state:u={},on:s={},slots:c={},onMount:i,onUnmount:a,onBeforeMount:p,onBeforeUnmount:_,onUpdate:I,onBeforeRender:$,...U}=o,b=null,y=!1,m={},T={},v=null,w=!1,k=[],x=u,M=null,S=!1,H={...u},P=!1,E=l=>{x=typeof l=="function"?l(x):{...x,...l},P||(P=!0,v={...m},queueMicrotask(()=>{P=!1,f(v),v=null}))},d={refs:{},on(){},setState:E,props:m,_childCallCache:{},_childCallIndex:0,isMounted:()=>y,_renderIndex:0,_mountedChildren:[],_unmountCbs:[],_mountCbs:[],_beforeMountCbs:[],_updateCbs:[],_beforeUnmountCbs:[],_beforeRenderCbs:[],onMount(l){l&&this._mountCbs.push(l)},onUnmount(l){l&&this._unmountCbs.push(l)},onBeforeMount(l){l&&this._beforeMountCbs.push(l)},onBeforeUnmount(l){l&&this._beforeUnmountCbs.push(l)},onUpdate(l){l&&this._updateCbs.push(l)},onBeforeRender(l){l&&this._beforeRenderCbs.push(l)},addEvent(l,h){this.on[l]=h},mount(l,h={}){if(y||w)return;let A=typeof l=="string"?document.querySelector(l):l;if(!A)throw new Error(`No element matches: ${l}`);let C=()=>{w=!0,b=A,b.setAttribute("data-comp-root",f._id+"-"+(r.name||"")),m={...m,...h},T={...m},d.props=m,b._componentInstance=f,m.key&&b.setAttribute("data-key",m.key),f(m),S||(y=!0,j(d._mountCbs,void 0,!1,f))};N(d._beforeMountCbs,C,f)},update(l={}){if(!y)return;let h=l.props||l;h.on&&Object.assign(this.on,h.on),T={...m},m={...m,...h},d.props=m,m.key!==T.key&&b.setAttribute("data-key",m.key),f(m)},render(l={}){m={...m,...l},d.props=m;let h=typeof r=="function"?r.call(f,{state:x,setState:E,props:m,refs:d.refs}):r,A=j(d._beforeRenderCbs,h,!1,f);return A&&(A=new String(A),A._id=f._id),te(d,f),A},_resetInternal:()=>{d._mountedChildren.forEach(l=>{l&&typeof l.unmount=="function"&&l.unmount()}),d._mountedChildren=[],M=null,S=!1,b=null,y=!1,w=!1,k=[],m={},T={},x={...H}},unmount(){if(!y||!b)return;let l=()=>{b.firstChild&&(M=b.firstChild.cloneNode(!0),b.removeChild(b.firstChild)),j(d._unmountCbs,void 0,!0,f),k.forEach(({node:h,type:A,listener:C})=>{h.removeEventListener(A,C)}),k=[],y=!1,w=!1,S=!0,re(f),d._resetInternal&&d._resetInternal()};N(d._beforeUnmountCbs,l,d)},get renderFn(){return r},get el(){return b},get state(){return x}};i&&d.onMount(i),a&&d.onUnmount(a),p&&d.onBeforeMount(p),_&&d.onBeforeUnmount(_),I&&d.onUpdate(I),$&&d.onBeforeRender($),Object.assign(d.on,s),d.ref=function(l){return O(this.el,l)},d.refs=new Proxy({},{get(l,h){return d.ref(h)}});function se(l){m={...d.props,...l},d.props=m,!b||b.isConnected;let h=d.render(m);if(h===null||h===""){!S&&b&&b.firstChild?(M=b.firstChild.cloneNode(!0),N(d._beforeUnmountCbs,()=>{b.innerHTML="",k.forEach(({node:C,type:ie,listener:ce})=>{C.removeEventListener(ie,ce)}),k=[],y=!1,S=!0,j(d._unmountCbs,void 0,!0,f)},d)):S=!0;return}if(S&&M){b.appendChild(M),M=null,S=!1,y=!0,V(f,b,f.on,k),j(d._mountCbs,void 0,!1,f);return}return z(b,h),G(f,m,d,c),X(f,b),V(f,b,f.on,k),y&&j(d._updateCbs,T,!1,f),S=!1,h}let W="";function f(l={}){if(!f._fromSlotHydration&&B&&B!==f){let h=B;h._childCallIndex==null&&(h._childCallIndex=0),h._childCallCache||(h._childCallCache={});let A=l.key!=null?l.key:h._childCallIndex++,C=h._childCallCache[A];return!C||C._templateSource!==f?(C=ge(f,l),C._prevProps={...l},C.toString=()=>`<div data-comp="${C._id}"></div>`,h._childCallCache[A]=C):(C._prevProps={...l},C.update(l)),C}return B=f,f._renderIndex=0,f._childCallIndex=0,f._prevProps=l,W=f._render(l),B=null,f}return f.toString=function(){return!W||String(W)===""&&!f.isMounted()&&B!==null&&B._id!==f._id?String(f._id):W?String(W):""},Object.assign(f,d,U),["el","props","state","setState"].forEach(l=>{Object.defineProperty(f,l,{get(){return d[l]},enumerable:!0,configurable:!1})}),f._render=se,f.render=d.render,f._id=_e++,f.getId=()=>f._id,ne(f),f._frozenTemplate=Object.freeze({renderFn:r,options:{...o,state:{...H}}}),f}function g(){return B}function ye(e,t={}){let n=g();if(!n)throw new Error("useFetch must be called inside a component render or lifecycle");(!n.state||n.state.data===void 0&&n.state.loading===void 0&&n.state.error===void 0)&&n.setState({data:null,loading:!0,error:null});async function r(){n.setState(o=>({...o,loading:!0}));try{let u=await(await fetch(e,t)).json();n.setState({data:u,error:null,loading:!1}),n.emit&&n.emit("fetch::done",{url:e,data:u})}catch(o){n.setState({data:null,error:o,loading:!1}),n.emit&&n.emit("fetch::error",{url:e,error:o})}}return n.onMount(r),n.onEmit&&n.onEmit("fetch::refresh",r),{get:()=>({...n.state}),subscribe:o=>(n.onUpdate(()=>o({...n.state})),()=>{}),refresh:r}}var Z={};function Ae(e,t={}){let n=g();if(!n)throw new Error("useContext() must be inside render()");Z[e]||(Z[e]={value:t,subs:new Set});let r=Z[e];r.subs.add(n),n.onUnmount(()=>r.subs.delete(n));let o=u=>{r.value=typeof u=="function"?u(r.value):u,r.subs.forEach(s=>s.update())};return[r.value,o]}function Ee(e){let t=g();if(!t)throw new Error("useState must be inside render()");t._hasStateSetters||(t.state&&Object.keys(t.state).forEach(o=>{let u="set"+o.charAt(0).toUpperCase()+o.slice(1);t[u]||(t[u]=s=>{let c=t.state[o],i=typeof s=="function"?s(c):s;i!==c&&(t.state[o]=i,t.update())})}),t._hasStateSetters=!0);let n=t._renderIndex++;t._hooks||(t._hooks=[]),t._hooks[n]===void 0&&(t._hooks[n]=typeof e=="function"?e():e);let r=o=>{let u=t._hooks[n],s=typeof o=="function"?o(u):o;s!==u&&(t._hooks[n]=s,t.update())};return[t._hooks[n],r]}function Se(e,t=[]){let n=g();if(!n)throw new Error("useEffect must be inside render()");let r=n._renderIndex++;n._hooks=n._hooks||[];let o=n._hooks[r]||[];if(t.length===0||t.some((s,c)=>s!==o[c])){let s;n.onUnmount(()=>s&&s()),s=e(),n._hooks[r]=t}}function Q(){let e=new Map;return{subscribe(t,n){e.has(t)||e.set(t,new Set);let r=e.get(t);return r.add(n),()=>r.delete(n)},emit(t,n){let r=e.get(t);if(r)for(let o of r)o(n)},clear(){e.clear()}}}function ve(e){let t=e,n=new Set;function r(s){typeof t=="object"&&t!==null&&typeof s=="object"&&s!==null&&!Array.isArray(t)&&!Array.isArray(s)?t={...t,...s}:t=typeof s=="function"?s(t):s,n.forEach(c=>c(t))}function o(s){return n.add(s),s(t),()=>n.delete(s)}function u(){return t}return{get:u,setState:r,getState:u,subscribe:o}}var L=Q(),D=new Map;function we(e,t={}){if(!D.has(e)){let n=ve(t),r={...n,emit(o,u){n.setState(u),L.emit(`${e}::${o}`,n.getState())},on(o,u){return L.subscribe(`${e}::${o}`,u)}};D.set(e,r)}return D.get(e)}we.clear=()=>D.clear();function xe(){let e=g();if(!e)throw new Error("useEmit must be inside render()");if(e._hasEmits)return e._emitsApi;e._hasEmits=!0;let t=Q(),n={emit:(r,o)=>t.emit(r,o),onEmit:(r,o)=>{let u=t.subscribe(r,o);return e.onUnmount(u),u},emitGlobal:(r,o)=>L.emit(r,o),onEmitGlobal:(r,o)=>{let u=L.subscribe(r,o);return e.onUnmount(u),u}};return Object.assign(e,n),e._emitsApi=n,e.onBeforeRender(function(){ke(e,e.on)}),e.onUnmount(()=>{t.clear()}),n}function ke(e,t={}){let n=[];Object.entries(t).forEach(([r,o])=>{if(r.includes("::")){let u=o.bind(e),s=L.subscribe(r,u);n.push(s)}else!r.includes(" ")&&!r.includes("*")&&!r.includes(":")&&e.onEmit(r,o.bind(e))}),e.onUnmount(()=>{n.forEach(r=>r()),n=[]})}function Me(){let e=g();if(!e)throw new Error("useEvent must be inside render()");e._eventApi&&e._eventApi;function t(u){let s={on(c,i){return e.addEvent(`${c} [data-ref=${u}]`,i),s},onClick(c){return this.on("click",c)},onBlur(c){return this.on("blur",c)},onInput(c){return this.on("input",c)},onChange(c){return this.on("change",c)},onFocus(c){return this.on("focus",c)},onSubmit(c){return this.on("submit",c)},toString(){return`data-ref="${u}"`}};return s}function n(u){return s=>{let c=`h${e._renderIndex++}`;return e.addEvent(`${u} [data-ref=${c}]`,s),t(c)}}let r={onClick:n("click"),onBlur:n("blur"),onInput:n("input"),onChange:n("change"),onFocus:n("focus"),onSubmit:n("submit"),on:(u,s)=>n(u)(s)},o={...e.on};return e.prototype.on=r.on,Object.assign(e.on,o),e._eventApi=r,r}function Ie(){let e=g();if(!e)throw new Error("useEvent must be inside render()");function t(c){return c.replace(/<([a-zA-Z0-9-]+)([^>]*?)>/gs,(i,a,p)=>{let _=[...p.matchAll(/data-ref="([^"]+)"/g)].map(U=>U[1]);if(_.length<=1)return i;let I=`data-ref="${_.join(" ")}"`,$=p.replace(/\s*data-ref="[^"]*"/g,"");return`<${a} ${I}${$}>`})}e.onBeforeRender(t);let n={...e.on},r=["click","dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","keydown","keyup","keypress","input","change","focus","blur","submit","contextmenu","wheel","touchstart","touchend","touchmove"];e.on=function(i,a){if(i&&a)return r.includes(i)?o(i,a):(e.addEvent(i,a),"")},Object.assign(e.on,n);function o(c,i){let a=`h${e._renderIndex++}`;return e.addEvent(`${c} [data-ref~=${a}]`,i),`data-ref="${a}"`}function u(c){return i=>o(c,i)}let s={};return r.forEach(c=>{let i="on"+c.charAt(0).toUpperCase()+c.slice(1);s[i]=u(c)}),s}return me($e);})();
//# sourceMappingURL=magnumjs-micro-ui-hooks.js.map
